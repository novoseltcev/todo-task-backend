<html lang="en">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="static/css/main.css">
    <script type="module" src="static/js/frontend.js"></script>
      <title>
          TODO Task Manager
      </title>
  </head>

  <body style="background: #b7b7b72e">
    <div class="Application">
      <ul class="vertical">
        <li><a href="">Sign In</a></li>
        <li><a href="">Sign Up</a></li>

        <li><a href="">Categories:</a></li>
        <ul>
          {% for category in categories %}
            <li>
                <form action="/category/" method="GET">
                    <input type="hidden" name="id" value={{ category['id'] }} >
                    <button type="submit">{{ category['name'] }}</button>
                </form>
            </li>
            {% endfor %}
        </ul>
      </ul>

      <div class="task_frame">
        {% for table_element in (("ToDo", 0), ("Done", 1)) %}
          <div class="container margin-top">
            <div class="row">
              <table class="table table-tasks">
                <thead>
                  <tr><th colspan="3">{{table_element[0]}}</th>
                  </tr>
                </thead>
                <tbody>
                    {% for category in categories %}
                        {% if category['id'] == current_category %}
                          {% for task in category['tasks'] %}
                            {% if task['status'] == table_element[1] %}
                              <tr>
                                <td style="padding-left: 30px;">{{task['title']}} </td>
                                <td style="width: 13px;">
                                  <form action="/task/status" method="PUT">
                                    {% if table_element[1] == 0 %}
                                      <input style="width: 13px;" class="t_button" type="checkbox">
                                    {% else %}
                                      <input style="width: 13px;" class="t_button" type="checkbox" checked>
                                    {% endif %}
                                  </form>
                                </td>
                                <td style="width: 40px;">
                                  <form action="/task/" method="DELETE">
                                    <input class="t_button" type="button" value="Delete">
                                  </form>
                                </td>
                                <td style="width: 50px;">
                                  {% for file in task['files'] %}
                                    <form action="/file/download" method="POST" enctype="multipart/form-data">
                                        <input type="hidden" name="id" value={{ file["id"] }} >
                                        <button type="submit">{{ file['name'] }}</button>
                                    </form>
                                    <form @submit.prevent="deleteFile({{ file['id'] }})">
                                      <input type="hidden" name="id" value={{ file["id"] }} >
                                      <button class="btn btn-danger" type="submit">Удалить</button>
                                    </form>
                                  {% endfor %}
                                  <form action="/file/" method="POST" enctype="multipart/form-data">
                                        <input type="file" name="file">
                                        <input type="hidden" name="task" value={{ task["id"] }} >
                                        <button type="submit">Прикрепить</button>
                                    </form>
                                </td>
                              </tr>
                            {% endif %}
                          {% endfor %}
                        {% endif %}
                    {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        {% endfor %}

        <form class="form-task" @submit.prevent="createTask">
          <input class="text_input" type="text" v-model="form_task.title">
          <button class="btn btn-primary" type="submit">Создать</button>
        </form>
      </div>
    </div>
  </body>
</html>
